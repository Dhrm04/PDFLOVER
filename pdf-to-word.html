<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PDF to Word - PDFLOVERS</title>
  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background: #f5f5f5;
      text-align: center;
    }
    .navbar {
      background: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    .logo {
      font-size: 1.5rem;
      font-weight: bold;
    }
    .nav-links a {
      margin: 0 10px;
      text-decoration: none;
      color: #333;
      font-weight: 500;
    }
    .dropdown {
      position: relative;
      display: inline-block;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: white;
      box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
      z-index: 1;
    }
    .dropdown:hover .dropdown-content {
      display: block;
    }
    .dropdown-content a {
      display: block;
      padding: 10px;
      color: #333;
      text-decoration: none;
    }
    .dropdown-content a:hover {
      background-color: #f0f0f0;
    }
    h1 {
      margin-top: 40px;
    }
    .description {
      margin: 10px auto 30px;
      max-width: 600px;
      font-size: 1rem;
      color: #555;
    }
    .upload-area {
      background: #fff;
      margin: auto;
      max-width: 500px;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .custom-btn {
      display: inline-block;
      margin: 10px 0;
      padding: 12px 20px;
      background-color: red;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }
    .custom-btn:hover {
      background-color: darkred;
    }
    input[type="file"] {
      display: none;
    }
    #output {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
  <script src="https://unpkg.com/docx@8.3.0/build/index.umd.js"></script>
</head>
<body>

  <header class="navbar">
    <div class="logo"><span style="color: red;">‚ù§Ô∏è</span> <strong>PDFLOVERS</strong></div>
    <nav class="nav-links">
      <a href="#">Merge PDF</a>
      <a href="#">Split PDF</a>
      <a href="#">Compress PDF</a>
      <div class="dropdown">
        <a href="#">Convert PDF ‚ñæ</a>
        <div class="dropdown-content">
          <a href="#">PDF to Word</a>
          <a href="#">PDF to Excel</a>
          <a href="#">PDF to PPT</a>
          <a href="#">PDF to JPG</a>
          <a href="#">JPG to PDF</a>
        </div>
      </div>
    </nav>
  </header>

  <h1>PDF to Word Converter</h1>
  <p class="description">Convert your PDF files to editable Word documents. Fast, secure and easy with PDFLOVERS.</p>

  <div class="upload-area">
    <label for="pdfFile" class="custom-btn">üìÅ Select PDF file</label>
    <input type="file" id="pdfFile" accept="application/pdf">
    <br>
    <button class="custom-btn" onclick="convertPDFtoWord()">Convert to Word</button>
    <div id="output"></div>
  </div>

  <script>
    const fileInput = document.getElementById('pdfFile');
    const output = document.getElementById('output');

    fileInput.addEventListener('change', () => {
      if (fileInput.files.length > 0) {
        output.style.color = 'green';
        output.innerHTML = '‚úÖ File uploaded successfully!';
      }
    });

    async function convertPDFtoWord() {
      const file = fileInput.files[0];
      output.innerHTML = '';

      if (!file) {
        output.style.color = 'red';
        output.innerHTML = '‚ö†Ô∏è Please select a PDF file.';
        return;
      }

      try {
        const reader = new FileReader();
        reader.onload = async function () {
          const typedArray = new Uint8Array(this.result);
          const pdf = await pdfjsLib.getDocument(typedArray).promise;

          const { Document, Packer, Paragraph, Media } = window.docx;
          const doc = new Document();
          const children = [];

          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const viewport = page.getViewport({ scale: 2 });
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = viewport.width;
            canvas.height = viewport.height;

            await page.render({ canvasContext: context, viewport }).promise;

            const content = await page.getTextContent();
            const text = content.items.map(item => item.str).join(' ').trim();

            if (text.length > 10) {
              children.push(new Paragraph(text));
            } else {
              const imageBase64 = canvas.toDataURL('image/jpeg');
              const image = Media.addImage(doc, imageBase64);
              children.push(image);
            }

            children.push(new Paragraph(""));
          }

          doc.addSection({ children });

          const blob = await Packer.toBlob(doc);
          const blobUrl = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = blobUrl;
          link.download = "converted.docx";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(blobUrl);

          output.style.color = 'green';
          output.innerHTML = '‚úÖ Word file created and downloading!';
        };
        reader.readAsArrayBuffer(file);
      } catch (e) {
        output.style.color = 'red';
        output.innerHTML = '‚ùå Error during conversion: ' + e.message;
        console.error(e);
      }
    }
  </script>
</body>
</html>
